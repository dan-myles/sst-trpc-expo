{"dependencies":[{"name":"@trpc/server/observable","data":{"asyncType":null,"exportNames":["*"],"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":53,"index":53}}],"key":"I122979nMYhHcuaUZWanjRGzbec="}},{"name":"../../internals/transformer.mjs","data":{"asyncType":null,"exportNames":["*"],"locs":[{"start":{"line":2,"column":0,"index":54},"end":{"line":2,"column":65,"index":119}}],"key":"kNCM79xqO+yFZcW4VpbtW8dQ36o="}},{"name":"./createWsClient.mjs","data":{"asyncType":null,"exportNames":["*"],"locs":[{"start":{"line":3,"column":0,"index":120},"end":{"line":3,"column":54,"index":174}}],"key":"AogTNPJZhO0EC3jZU5kGtwpS4CE="}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  Object.defineProperty(exports, \"createWSClient\", {\n    enumerable: true,\n    get: function () {\n      return _createWsClient.createWSClient;\n    }\n  });\n  exports.wsLink = wsLink;\n  var _observable = require(_dependencyMap[0], \"@trpc/server/observable\");\n  var _transformer = require(_dependencyMap[1], \"../../internals/transformer.mjs\");\n  var _createWsClient = require(_dependencyMap[2], \"./createWsClient.mjs\");\n  function wsLink(opts) {\n    var client = opts.client;\n    var transformer = (0, _transformer.getTransformer)(opts.transformer);\n    return () => {\n      return _ref => {\n        var op = _ref.op;\n        return (0, _observable.observable)(observer => {\n          var connStateSubscription = op.type === 'subscription' ? client.connectionState.subscribe({\n            next(result) {\n              observer.next({\n                result,\n                context: op.context\n              });\n            }\n          }) : null;\n          var requestSubscription = client.request({\n            op,\n            transformer\n          }).subscribe(observer);\n          return () => {\n            requestSubscription.unsubscribe();\n            connStateSubscription?.unsubscribe();\n          };\n        });\n      };\n    };\n  }\n});","lineCount":42,"map":[[12,2,1,0],[12,6,1,0,"_observable"],[12,17,1,0],[12,20,1,0,"require"],[12,27,1,0],[12,28,1,0,"_dependencyMap"],[12,42,1,0],[13,2,2,0],[13,6,2,0,"_transformer"],[13,18,2,0],[13,21,2,0,"require"],[13,28,2,0],[13,29,2,0,"_dependencyMap"],[13,43,2,0],[14,2,3,0],[14,6,3,0,"_createWsClient"],[14,21,3,0],[14,24,3,0,"require"],[14,31,3,0],[14,32,3,0,"_dependencyMap"],[14,46,3,0],[15,2,5,0],[15,11,5,9,"wsLink"],[15,17,5,15,"wsLink"],[15,18,5,16,"opts"],[15,22,5,20],[15,24,5,22],[16,4,6,4],[16,8,6,12,"client"],[16,14,6,18],[16,17,6,23,"opts"],[16,21,6,27],[16,22,6,12,"client"],[16,28,6,18],[17,4,7,4],[17,8,7,10,"transformer"],[17,19,7,21],[17,22,7,24],[17,26,7,24,"getTransformer"],[17,53,7,38],[17,55,7,39,"opts"],[17,59,7,43],[17,60,7,44,"transformer"],[17,71,7,55],[17,72,7,56],[18,4,8,4],[18,11,8,11],[18,17,8,15],[19,6,9,8],[19,13,9,15,"_ref"],[19,17,9,15],[19,21,9,25],[20,8,9,25],[20,12,9,18,"op"],[20,14,9,20],[20,17,9,20,"_ref"],[20,21,9,20],[20,22,9,18,"op"],[20,24,9,20],[21,8,10,12],[21,15,10,19],[21,19,10,19,"observable"],[21,41,10,29],[21,43,10,31,"observer"],[21,51,10,39],[21,55,10,42],[22,10,11,16],[22,14,11,22,"connStateSubscription"],[22,35,11,43],[22,38,11,46,"op"],[22,40,11,48],[22,41,11,49,"type"],[22,45,11,53],[22,50,11,58],[22,64,11,72],[22,67,11,75,"client"],[22,73,11,81],[22,74,11,82,"connectionState"],[22,89,11,97],[22,90,11,98,"subscribe"],[22,99,11,107],[22,100,11,108],[23,12,12,20,"next"],[23,16,12,24,"next"],[23,17,12,26,"result"],[23,23,12,32],[23,25,12,34],[24,14,13,24,"observer"],[24,22,13,32],[24,23,13,33,"next"],[24,27,13,37],[24,28,13,38],[25,16,14,28,"result"],[25,22,14,34],[26,16,15,28,"context"],[26,23,15,35],[26,25,15,37,"op"],[26,27,15,39],[26,28,15,40,"context"],[27,14,16,24],[27,15,16,25],[27,16,16,26],[28,12,17,20],[29,10,18,16],[29,11,18,17],[29,12,18,18],[29,15,18,21],[29,19,18,25],[30,10,19,16],[30,14,19,22,"requestSubscription"],[30,33,19,41],[30,36,19,44,"client"],[30,42,19,50],[30,43,19,51,"request"],[30,50,19,58],[30,51,19,59],[31,12,20,20,"op"],[31,14,20,22],[32,12,21,20,"transformer"],[33,10,22,16],[33,11,22,17],[33,12,22,18],[33,13,22,19,"subscribe"],[33,22,22,28],[33,23,22,29,"observer"],[33,31,22,37],[33,32,22,38],[34,10,23,16],[34,17,23,23],[34,23,23,27],[35,12,24,20,"requestSubscription"],[35,31,24,39],[35,32,24,40,"unsubscribe"],[35,43,24,51],[35,44,24,52],[35,45,24,53],[36,12,25,20,"connStateSubscription"],[36,33,25,41],[36,35,25,43,"unsubscribe"],[36,46,25,54],[36,47,25,55],[36,48,25,56],[37,10,26,16],[37,11,26,17],[38,8,27,12],[38,9,27,13],[38,10,27,14],[39,6,28,8],[39,7,28,9],[40,4,29,4],[40,5,29,5],[41,2,30,0],[42,0,30,1],[42,3]],"functionMap":{"names":["<global>","wsLink","<anonymous>","observable$argument_0","client.connectionState.subscribe$argument_0.next"],"mappings":"AAA;ACI;WCG;8BCE;oBCE;qBDK;uBDM;iBCG;aDC;KDE;CDC"}},"type":"js/module"}]}